<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="sid-38422fae-e03e-43a3-bef4-bd33b32041b2" targetNamespace="http://bpmn.io/bpmn" exporter="bpmn-js-token-simulation" exporterVersion="0.1.5">
  <process id="Process_1" isExecutable="true">
    <sequenceFlow id="Flow_0bt1i2p" />
    <sequenceFlow id="Flow_0rrv776" />
    <startEvent id="Event_1p8m9t0">
      <outgoing>Flow_0ovq5u3</outgoing>
    </startEvent>
    <endEvent id="Event_0ptptg8">
      <incoming>Flow_0tm7azx</incoming>
      <incoming>Flow_0p2f8sz</incoming>
    </endEvent>
    <scriptTask id="Activity_07cjvvm" name="end" scriptFormat="JavaScript">
      <incoming>Flow_15dz1o9</incoming>
      <outgoing>Flow_0tm7azx</outgoing>
      <script>var node = this.environment.variables.ros_node;
const publisher = node.createPublisher("geometry_msgs/msg/Twist", "cmd_vel");
publisher.publish({
linear: {x: 0.0, y: 0.0, z: 0.0},
angular: {x: 0.0, y: 0.0, z: 0.0}
});
this.environment.variables.ended = true
this.environment.services.console.log("hfoiyegiuZEHF")
next();
this.environment.services.console.log("end")
next();</script>
    </scriptTask>
    <sequenceFlow id="Flow_0tm7azx" sourceRef="Activity_07cjvvm" targetRef="Event_0ptptg8" />
    <intermediateCatchEvent id="Event_16irvp2">
      <incoming>Flow_1bfhk42</incoming>
      <outgoing>Flow_15dz1o9</outgoing>
      <timerEventDefinition id="TimerEventDefinition_0nvtpdv">
        <timeDuration xsi:type="tFormalExpression">PT10S</timeDuration>
      </timerEventDefinition>
    </intermediateCatchEvent>
    <sequenceFlow id="Flow_1bfhk42" sourceRef="Gateway_0uq3r3f" targetRef="Event_16irvp2" />
    <sequenceFlow id="Flow_15dz1o9" sourceRef="Event_16irvp2" targetRef="Activity_07cjvvm" />
    <parallelGateway id="Gateway_0uq3r3f">
      <incoming>Flow_10segf8</incoming>
      <outgoing>Flow_1bfhk42</outgoing>
      <outgoing>Flow_1jjeijq</outgoing>
    </parallelGateway>
    <scriptTask id="Activity_0jz710x" name="turn" scriptFormat="JavaScript" camunda:resultVariable="">
      <incoming>Flow_1jjeijq</incoming>
      <outgoing>Flow_0p2f8sz</outgoing>
      <script>var node = this.environment.variables.ros_node;
const publisher = node.createPublisher("geometry_msgs/msg/Twist", "cmd_vel");
this.environnement.variables.n = 0;

while(this.environment.variables.ended == false){
publisher.publish({
linear: {x: 0.0, y: 0.0, z: 0.0},
angular: {x: 0.0, y: 0.0, z: 0.5}
});
n++;
this.environment.services.console.log("command sent ",n," times");}
next();</script>
    </scriptTask>
    <sequenceFlow id="Flow_1jjeijq" sourceRef="Gateway_0uq3r3f" targetRef="Activity_0jz710x" />
    <scriptTask id="Activity_1cc1xx6" name="setup" scriptFormat="JavaScript">
      <incoming>Flow_0ovq5u3</incoming>
      <outgoing>Flow_10segf8</outgoing>
      <script>this.environment.variables.ended = false
next();</script>
    </scriptTask>
    <sequenceFlow id="Flow_0ovq5u3" sourceRef="Event_1p8m9t0" targetRef="Activity_1cc1xx6" />
    <sequenceFlow id="Flow_10segf8" sourceRef="Activity_1cc1xx6" targetRef="Gateway_0uq3r3f" />
    <sequenceFlow id="Flow_0p2f8sz" sourceRef="Activity_0jz710x" targetRef="Event_0ptptg8" />
  </process>
  <bpmndi:BPMNDiagram id="BpmnDiagram_1">
    <bpmndi:BPMNPlane id="BpmnPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="Event_1p8m9t0_di" bpmnElement="Event_1p8m9t0">
        <omgdc:Bounds x="82" y="322" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0ptptg8_di" bpmnElement="Event_0ptptg8">
        <omgdc:Bounds x="802" y="322" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0ym9kta_di" bpmnElement="Event_16irvp2">
        <omgdc:Bounds x="452" y="232" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0vvajzw_di" bpmnElement="Gateway_0uq3r3f">
        <omgdc:Bounds x="315" y="315" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0r5if1h_di" bpmnElement="Activity_1cc1xx6">
        <omgdc:Bounds x="170" y="300" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0tw46x5_di" bpmnElement="Activity_07cjvvm">
        <omgdc:Bounds x="660" y="210" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1y0fbaq_di" bpmnElement="Activity_0jz710x">
        <omgdc:Bounds x="470" y="380" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0tm7azx_di" bpmnElement="Flow_0tm7azx">
        <omgdi:waypoint x="760" y="250" />
        <omgdi:waypoint x="820" y="250" />
        <omgdi:waypoint x="820" y="322" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1bfhk42_di" bpmnElement="Flow_1bfhk42">
        <omgdi:waypoint x="340" y="315" />
        <omgdi:waypoint x="340" y="250" />
        <omgdi:waypoint x="452" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_15dz1o9_di" bpmnElement="Flow_15dz1o9">
        <omgdi:waypoint x="488" y="250" />
        <omgdi:waypoint x="660" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1jjeijq_di" bpmnElement="Flow_1jjeijq">
        <omgdi:waypoint x="340" y="365" />
        <omgdi:waypoint x="340" y="420" />
        <omgdi:waypoint x="470" y="420" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ovq5u3_di" bpmnElement="Flow_0ovq5u3">
        <omgdi:waypoint x="118" y="340" />
        <omgdi:waypoint x="170" y="340" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10segf8_di" bpmnElement="Flow_10segf8">
        <omgdi:waypoint x="270" y="340" />
        <omgdi:waypoint x="315" y="340" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0p2f8sz_di" bpmnElement="Flow_0p2f8sz">
        <omgdi:waypoint x="570" y="420" />
        <omgdi:waypoint x="820" y="420" />
        <omgdi:waypoint x="820" y="358" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
